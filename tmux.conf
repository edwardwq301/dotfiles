# ==============================================================================
# Basic Settings
# ==============================================================================

# Position status bar at the top
set-option -g status-position top

# Terminal and display settings
set -g default-terminal "screen-256color"
set -g display-time 3000                    # Message display time in ms
set -g history-limit 65535                  # Increase scrollback buffer size
set -sg escape-time 10                      # Reduce delay for ESC in Neovim

# Numbering settings
set -g base-index 1                         # Start window numbering at 1
set -g pane-base-index 1                    # Start pane numbering at 1

# ==============================================================================
# Key Bindings - Prefix and Navigation
# ==============================================================================

# Change prefix from C-b to M-a (Alt+a)
set -g prefix M-a
unbind C-b
bind-key M-a send-prefix

# Unbind default session switching keys
unbind o
unbind C-o

# Window and pane splitting with current path
unbind %
bind | split-window -h -c "#{pane_current_path}"
unbind '"'
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}" # New window in current directory

# Pane navigation (vim style)
bind -r k select-pane -U                    # Move to upper pane
bind -r j select-pane -D                    # Move to lower pane
bind -r h select-pane -L                    # Move to left pane
bind -r l select-pane -R                    # Move to right pane

# Pane resizing with Ctrl modifier
bind -r ^k resizep -U 10                    # Resize pane upward
bind -r ^j resizep -D 10                    # Resize pane downward
bind -r ^h resizep -L 10                    # Resize pane left
bind -r ^l resizep -R 10                    # Resize pane right

# Zoom pane toggle
bind -r m resize-pane -Z

# ==============================================================================
# Mouse and Selection Settings
# ==============================================================================

# Enable mouse support
set -g mouse on

# Vi-style key bindings in copy mode
set-window-option -g mode-keys vi

# Copy mode key bindings
bind-key -T copy-mode-vi 'v' send -X begin-selection    # Start selection
bind-key -T copy-mode-vi 'y' send -X copy-selection      # Yank selection
unbind -T copy-mode-vi MouseDragEnd1Pane                 # Keep copy mode on mouse drag

# ==============================================================================
# Window and Pane Management
# ==============================================================================

# Window naming settings
setw -g automatic-rename off
setw -g allow-rename off
set -g renumber-windows on
set -g renumber-pane on

# ==============================================================================
# Plugin Configuration
# ==============================================================================

# List of TPM plugins
set -g @plugin 'tmux-plugins/tpm'           # Tmux Plugin Manager
set -g @plugin 'mike-rambil/tmux-catppuccin' # Catppuccin theme
set -g @plugin 'tmux-plugins/tmux-resurrect' # Session persistence
set -g @plugin 'tmux-plugins/tmux-continuum' # Auto-save sessions
set -g @plugin '27medkamal/tmux-session-wizard'
set -g @plugin 'omerxx/tmux-sessionx'       # Session manager

# Plugin-specific settings
set -g @resurrect-capture-pane-contents 'on' # Save pane contents
set -g @continuum-restore 'on'              # Auto-restore sessions
set -g @sessionx-bind 'C-o'                 # Sessionx trigger key
set -g @session-wizard 't'                  # Session wizard key

# ==============================================================================
# Catppuccin Theme Configuration
# ==============================================================================

# Theme flavor (mocha, macchiato, frappe, latte)
set -g @catppuccin_flavor 'mocha'

# Window status decorations
set -g @catppuccin_window_left_separator ""
set -g @catppuccin_window_right_separator " "
set -g @catppuccin_window_middle_separator " █"
set -g @catppuccin_window_number_position "right"

# Window text formatting
set -g @catppuccin_window_default_fill "number"
set -g @catppuccin_window_default_text "#W"
set -g @catppuccin_window_current_fill "number"
set -g @catppuccin_window_current_text "#W"

# Status bar modules and styling
set -g @catppuccin_status_modules_right "user host session"
set -g @catppuccin_status_left_separator " "
set -g @catppuccin_status_right_separator ""
set -g @catppuccin_status_right_separator_inverse "no"
set -g @catppuccin_status_fill "icon"
set -g @catppuccin_status_connect_separator "no"
set -g @catppuccin_status_background "default"

# Directory display setting
set -g @catppuccin_directory_text "#{pane_current_path}"

# Transparent status bar
set status-bg default
set -g status-style fg=default,bg=default

# ==============================================================================
# Utility Key Bindings
# ==============================================================================

# Reload configuration file
unbind r
bind r source-file ~/.tmux.conf \; display-message "Configuration reloaded!"

# Quick reload binding with feedback
bind M-r source-file ~/.tmux.conf \; display-message "Configuration reloaded successfully!"

# ==============================================================================
# Plugin Manager Initialization
# ==============================================================================

# Initialize TMUX plugin manager (keep this line at the very bottom)
run '~/.tmux/plugins/tpm/tpm'